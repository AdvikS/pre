---
output:
  md_document:
    variant: markdown_github
bibliography: README.bib
csl: inst/bib_style.csl
---

# pre: An R package for deriving prediction rule ensembles

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "inst/README-figures/README-",
  dpi = 124
)
```

pre is an R package for deriving prediction rule ensembles for binary and continuous outcome variables. Input variables may be numeric, ordinal and nominal. The package implements the algorithm for deriving prediction rule ensembles as described in [@Friedman08], with some improvements and adjustments. The most important improvements and adjustments are: 

1) The pre package is completely R based, allowing users better access to the results and more control over the parameters used for generating the prediction rule ensemble
2) An unbiased tree induction algorithm is used for deriving prediction rules. [@Friedman08] employed the classification and regression tree (CART) algorithm, but this suffers from biased variable selection.
3) The package allows for plotting the final rule ensemble as a collection of simple decision trees.
4) The initial ensemble of prediction rules can be generated as a bagged, boosted and/or random forest ensemble.

The pre package is developed to provide useRs a completely R based implementation of the algorithm described by [@Friedman08]. However, note that pre is under development, and much work still needs to be done. See [@Fokkema15] for an application of the methods.

# Examples

To get a first impression of how pre works, we will fit a prediction rule ensemble to predict Ozone levels using the airqality dataset:

```{r, results = FALSE}
library(pre)
set.seed(42)
complete <- complete.cases(airquality)
airq.ens <- pre(Ozone ~ ., data = airquality[complete, ])
```

The following functions allow for inspecting and plotting the resulting ensemble: 

```{r}
print(airq.ens)
plot(airq.ens, max.terms.plot = 9, cex = .5)
head(coef(airq.ens))
importance(airq.ens)
```

Using the predict() function, predictions for new observations can be generated:

```{r}
airq.preds <- predict(airq.ens, newdata = airquality[1:4,])
```

The effect of a given predictor variable on the outcome can be assessed through a partial dependence plot:

```{r}
singleplot(airq.ens, varname = "Temp")
```

The expected prediction error of the prediction rule ensemble (by default calculated based on 10-fold cross validation) using the cvpre() function:

```{r}
set.seed(43)
airq.cv <- cvpre(airq.ens)
airq.cv$accuracy
```

# References